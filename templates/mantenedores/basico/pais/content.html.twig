{#
  TEMPLATE MANTENEDOR - Países
  ===========================
  
  PATRÓN FRONTEND PARA MANTENEDORES
  ================================
  Este template implementa la interfaz estándar para mantenedores del sistema Melisa.
  Diseñado para funcionar con el sistema AJAX de carga dinámica de contenido.
  
  ESTRUCTURA DEL TEMPLATE:
  1. Encabezado con título y botón de acción
  2. Tabla responsiva con datos
  3. Modal para formularios (crear/editar)
  4. JavaScript embebido para interacciones
  
  PARA NUEVOS MANTENEDORES:
  ========================
  1. Copia este template y ajusta los nombres (reemplaza 'pais' por tu entidad)
  2. Modifica los campos del formulario según tu modelo
  3. Actualiza las columnas de la tabla
  4. Ajusta las validaciones JavaScript
  5. Personaliza los mensajes y textos
  
  CONVENCIONES DE NOMBRES:
  - Modal ID: {entidad}Modal (ej: paisModal, ciudadModal)
  - Form ID: {entidad}Form
  - Campos: usar nombres exactos del modelo de datos
  - Botones: data-action="create|edit|delete"
  
  DEPENDENCIAS:
  - Bootstrap 5.3 (modal, form, table)
  - SweetAlert2 (confirmaciones y notificaciones)
  - Sistema AJAX global (mantenedores/index.html.twig)
  
  @author Equipo Melisa - Frontend
  @version 1.0
  @since 2025-10-20
#}

{# ============================================= #}
{# CONTENIDO PRINCIPAL DEL MANTENEDOR #}
{# ============================================= #}
<div class="row" 
     data-controller="mantenedores--pais--pais"
     data-mantenedores--pais--pais-entity-name-value="País"
     data-mantenedores--pais--pais-entity-name-plural-value="Países"
     data-mantenedores--pais--pais-api-base-value="/mantenedores/basico/pais"
     data-mantenedores--pais--pais-modal-id-value="paisModal">
    <div class="col-12">
        {# TARJETA PRINCIPAL #}
        <div class="card shadow-sm">
            {# ENCABEZADO DE LA TARJETA #}
            <div class="card-header bg-primary text-white d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center">
                    <i class="fas fa-globe me-2"></i>
                    <h5 class="card-title mb-0">{{ 'mantenedores.pais.title'|trans }}</h5>
                </div>
                {# BOTÓN PARA CREAR NUEVO REGISTRO #}
                <button type="button" class="btn btn-light btn-sm" 
                        data-bs-toggle="modal" 
                        data-bs-target="#paisModal" 
                        data-action="click->mantenedores--pais--pais#handleCreate"
                        title="{{ 'mantenedores.pais.nuevo'|trans }}">
                    <i class="fas fa-plus me-1"></i> 
                    {{ 'mantenedores.pais.nuevo'|trans }}
                </button>
            </div>
            
            {# CUERPO DE LA TARJETA #}
            <div class="card-body">
                {# MANEJO DE ERRORES #}
                {% if error is defined and error %}
                    <div class="alert alert-danger alert-dismissible fade show" role="alert">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>{{ 'notifications.error'|trans }}:</strong> {{ error }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="{{ 'actions.close'|trans }}"></button>
                    </div>
                {% endif %}

                {# INFORMACIÓN DEL TENANT (SOLO PARA DEBUG/DESARROLLO) #}
                {% if tenant is defined and app.environment == 'dev' %}
                    <div class="alert alert-info alert-dismissible fade show" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Tenant:</strong> {{ tenant.name }} ({{ tenant.subdomain }})
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="{{ 'actions.close'|trans }}"></button>
                    </div>
                {% endif %}

                {# ESTADO VACÍO - NO HAY REGISTROS #}
                {% if paises is empty %}
                    <div class="text-center py-5">
                        <div class="mb-4">
                            <i class="fas fa-globe fa-4x text-muted opacity-50"></i>
                        </div>
                        <h5 class="text-muted mb-2">{{ 'mantenedores.pais.info.no_countries'|trans }}</h5>
                        <p class="text-muted mb-4">
                            {{ 'mantenedores.pais.info.first_country'|trans }}
                        </p>
                        <button type="button" class="btn btn-primary" 
                                data-bs-toggle="modal" 
                                data-bs-target="#paisModal" 
                                data-action="click->mantenedores--pais--pais#handleCreate">
                            <i class="fas fa-plus me-2"></i>
                            {{ 'mantenedores.pais.info.create_first'|trans }}
                        </button>
                    </div>
                {% else %}
                    {# TABLA DE DATOS #}
                    <div class="table-responsive">
                        <table class="table table-striped table-hover align-middle">
                            {# ENCABEZADOS DE LA TABLA #}
                            <thead class="table-dark">
                                <tr>
                                    <th scope="col" class="text-center" style="width: 80px;">
                                        <i class="fas fa-hashtag me-1"></i>{{ 'mantenedores.pais.id'|trans }}
                                    </th>
                                    <th scope="col">
                                        <i class="fas fa-flag me-1"></i>{{ 'mantenedores.pais.nombre_pais'|trans }}
                                    </th>
                                    <th scope="col">
                                        <i class="fas fa-users me-1"></i>{{ 'mantenedores.pais.gentilicio'|trans }}
                                    </th>
                                    <th scope="col" class="text-center" style="width: 100px;">
                                        <i class="fas fa-toggle-on me-1"></i>{{ 'mantenedores.pais.estado'|trans }}
                                    </th>
                                    <th scope="col" class="text-center" style="width: 150px;">
                                        <i class="fas fa-cogs me-1"></i>{{ 'mantenedores.pais.acciones'|trans }}
                                    </th>
                                </tr>
                            </thead>
                            {# DATOS DE LA TABLA #}
                            <tbody>
                                {% for pais in paises %}
                                    <tr>
                                        {# ID DEL REGISTRO #}
                                        <td class="text-center">
                                            <span class="badge bg-secondary">{{ pais.idPais }}</span>
                                        </td>
                                        
                                        {# NOMBRE DEL PAÍS #}
                                        <td>
                                            <strong>{{ pais.nombrePais }}</strong>
                                        </td>
                                        
                                        {# GENTILICIO #}
                                        <td>
                                            <span class="text-muted">{{ pais.nombreGentilicio }}</span>
                                        </td>
                                        
                                        {# ESTADO ACTIVO/INACTIVO #}
                                        <td class="text-center">
                                            {% if pais.activo %}
                                                <span class="badge bg-success">
                                                    <i class="fas fa-check me-1"></i>{{ 'mantenedores.pais.states.active'|trans }}
                                                </span>
                                            {% else %}
                                                <span class="badge bg-secondary">
                                                    <i class="fas fa-times me-1"></i>{{ 'mantenedores.pais.states.inactive'|trans }}
                                                </span>
                                            {% endif %}
                                        </td>
                                        
                                        {# BOTONES DE ACCIÓN #}
                                        <td class="text-center">
                                            <div class="btn-group" role="group" aria-label="{{ 'mantenedores.pais.acciones'|trans }}">
                                                {# BOTÓN EDITAR #}
                                                <button type="button" 
                                                        class="btn btn-outline-primary btn-sm" 
                                                        data-bs-toggle="modal" 
                                                        data-bs-target="#paisModal" 
                                                        data-action="click->mantenedores--pais--pais#handleEdit" 
                                                        data-id="{{ pais.idPais }}"
                                                        title="{{ 'mantenedores.pais.editar'|trans }} {{ pais.nombrePais }}">
                                                    <i class="fas fa-edit"></i>
                                                </button>
                                                
                                                {# BOTÓN ELIMINAR #}
                                                <button type="button" 
                                                        class="btn btn-outline-danger btn-sm" 
                                                        data-action="click->mantenedores--pais--pais#handleDelete" 
                                                        data-id="{{ pais.idPais }}" 
                                                        data-name="{{ pais.nombrePais }}"
                                                        title="{{ 'mantenedores.pais.eliminar'|trans }} {{ pais.nombrePais }}">
                                                    <i class="fas fa-trash"></i>
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                    
                    {# INFORMACIÓN ADICIONAL DE LA TABLA #}
                    <div class="d-flex justify-content-between align-items-center mt-3">
                        <small class="text-muted">
                            <i class="fas fa-list me-1"></i>
                            {{ 'mantenedores.pais.info.showing_results'|trans({'%count%': paises|length}) }}
                        </small>
                        
                        {# ESPACIO PARA PAGINACIÓN (FUTURO) #}
                        <div class="d-flex">
                            {# Aquí se puede agregar paginación en el futuro #}
                        </div>
                    </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

{# ============================================= #}
{# MODAL PARA CREAR/EDITAR REGISTROS #}
{# ============================================= #}
<div class="modal fade" 
     id="paisModal" 
     tabindex="-1" 
     aria-labelledby="paisModalLabel" 
     aria-hidden="true"
     data-mantenedores--pais--pais-target="modal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            {# ENCABEZADO DEL MODAL #}
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title" 
                    id="paisModalLabel"
                    data-mantenedores--pais--pais-target="title">
                    <i class="fas fa-globe me-2"></i>
                    {{ 'mantenedores.pais.nuevo'|trans }}
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="{{ 'actions.close'|trans }}"></button>
            </div>
            
            {# FORMULARIO PRINCIPAL #}
            <form id="paisForm" 
                  novalidate
                  data-mantenedores--pais--pais-target="form">
                <div class="modal-body">
                    {# CAMPOS OCULTOS #}
                    <input type="hidden" 
                           id="paisId" 
                           name="paisId"
                           data-mantenedores--pais--pais-target="idField">
                    <input type="hidden" name="_token" value="{{ csrf_token }}">
                    
                    {# CAMPO: NOMBRE DEL PAÍS #}
                    <div class="mb-3">
                        <label for="nombrePais" class="form-label">
                            <i class="fas fa-flag me-1 text-primary"></i>
                            {{ 'mantenedores.pais.nombre_pais'|trans }}
                            <span class="text-danger">*</span>
                        </label>
                        <div class="input-group">
                            <input type="text" 
                                   class="form-control" 
                                   id="nombrePais" 
                                   name="nombrePais" 
                                   required
                                   placeholder="{{ 'mantenedores.pais.placeholder.nombre_pais'|trans }}"
                                   maxlength="100"
                                   data-mantenedores--pais--pais-target="nombrePais"
                                   data-action="input->mantenedores--pais--pais#validateField blur->mantenedores--pais--pais#formatToTitle">
                            <button class="btn btn-outline-secondary" 
                                    type="button"
                                    data-action="click->mantenedores--pais--pais#autoGenerateGentilicio"
                                    title="{{ 'mantenedores.pais.info.auto_generate'|trans }}">
                                <i class="fas fa-magic"></i>
                            </button>
                        </div>
                        <div class="invalid-feedback">
                            {{ 'mantenedores.pais.validation.nombre_required'|trans }}
                        </div>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            {{ 'mantenedores.pais.info.nombre_help'|trans }}
                        </div>
                    </div>
                    
                    {# CAMPO: GENTILICIO #}
                    <div class="mb-3">
                        <label for="nombreGentilicio" class="form-label">
                            <i class="fas fa-users me-1 text-primary"></i>
                            {{ 'mantenedores.pais.gentilicio'|trans }}
                            <span class="text-danger">*</span>
                        </label>
                        <input type="text" 
                               class="form-control" 
                               id="nombreGentilicio" 
                               name="nombreGentilicio" 
                               required
                               placeholder="{{ 'mantenedores.pais.placeholder.gentilicio'|trans }}"
                               maxlength="100"
                               data-mantenedores--pais--pais-target="nombreGentilicio"
                               data-action="input->mantenedores--pais--pais#validateField blur->mantenedores--pais--pais#formatToTitle">
                        <div class="invalid-feedback">
                            {{ 'mantenedores.pais.validation.gentilicio_required'|trans }}
                        </div>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            {{ 'mantenedores.pais.info.gentilicio_help'|trans }}
                        </div>
                    </div>
                    
                    {# CAMPO: ESTADO ACTIVO #}
                    <div class="mb-3">
                        <div class="form-check form-switch">
                            <input class="form-check-input" 
                                   type="checkbox" 
                                   id="activo" 
                                   name="activo" 
                                   checked
                                   data-mantenedores--pais--pais-target="activo">
                            <label class="form-check-label" for="activo">
                                <i class="fas fa-toggle-on me-1 text-success"></i>
                                {{ 'mantenedores.pais.activo'|trans }}
                            </label>
                        </div>
                        <div class="form-text">
                            <i class="fas fa-info-circle me-1"></i>
                            {{ 'mantenedores.pais.info.activo_help'|trans }}
                        </div>
                    </div>
                    
                    {# CAMPOS OBLIGATORIOS - NOTA #}
                    <div class="alert alert-info d-flex align-items-center" role="alert">
                        <i class="fas fa-info-circle me-2"></i>
                        <div>
                            <small>
                                <strong>{{ 'notifications.info'|trans }}:</strong> {{ 'mantenedores.pais.info.required_fields'|trans }}
                            </small>
                        </div>
                    </div>
                </div>
                
                {# PIE DEL MODAL - BOTONES DE ACCIÓN #}
                <div class="modal-footer bg-light">
                    <button type="button" 
                            class="btn btn-secondary" 
                            data-bs-dismiss="modal">
                        <i class="fas fa-times me-1"></i>
                        {{ 'actions.cancel'|trans }}
                    </button>
                    <button type="button" 
                            class="btn btn-outline-info me-2"
                            data-action="click->mantenedores--pais--pais#clearForm">
                        <i class="fas fa-eraser me-1"></i>
                        {{ 'actions.clear'|trans }}
                    </button>
                    <button type="submit" 
                            class="btn btn-primary"
                            data-mantenedores--pais--pais-target="submitButton">
                        <i class="fas fa-save me-1"></i>
                        {{ 'actions.save'|trans }} {{ 'mantenedores.pais.entity_name'|trans }}
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

{# ============================================= #}
{# JAVASCRIPT MIGRADO A STIMULUS #}
{# ============================================= #}
{# 
  El JavaScript ha sido migrado a Stimulus controllers:
  - Funcionalidad común: /assets/controllers/mantenedores/base_controller.js
  - Lógica específica de países: /assets/controllers/mantenedores/pais/pais_controller.js
  
  Los controladores se configuran mediante data-controller y data-target en el HTML.
  
  VENTAJAS DE STIMULUS:
  - Código más limpio y reutilizable
  - Mejor separación de responsabilidades
  - Facilita la creación de nuevos mantenedores
  - Integración nativa con Symfony UX
#}

{# ============================================= #}
{# ESTILOS ESPECÍFICOS DEL MANTENEDOR #}
{# ============================================= #}
<style>
/**
 * ESTILOS PERSONALIZADOS PARA MANTENEDOR
 * =====================================
 * 
 * Estilos específicos que complementan Bootstrap para mejorar
 * la experiencia de usuario en el mantenedor de países.
 */

/* Mejoras visuales para la tabla */
.table-responsive .table th {
    border-top: none;
    font-weight: 600;
    letter-spacing: 0.5px;
}

.table-responsive .table td {
    vertical-align: middle;
}

/* Hover mejorado para filas */
.table-hover tbody tr:hover {
    background-color: rgba(0, 123, 255, 0.05);
    transform: translateY(-1px);
    transition: all 0.2s ease;
}

/* Botones de acción */
.btn-group .btn {
    transition: all 0.2s ease;
}

.btn-group .btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

/* Estados de validación mejorados */
.was-validated .form-control:valid {
    border-color: #28a745;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='8' height='8' viewBox='0 0 8 8'%3e%3cpath fill='%2328a745' d='m2.3 6.73.03-.03L5.05 4 2.33 1.27c-.2-.2-.54-.2-.74 0-.2.2-.2.54 0 .74L3.66 4 1.59 6.07c-.2.2-.2.54 0 .74.1.1.23.15.37.15s.27-.05.37-.15z'/%3e%3c/svg%3e");
}

.was-validated .form-control:invalid {
    border-color: #dc3545;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='none' stroke='%23dc3545' viewBox='0 0 12 12'%3e%3ccircle cx='6' cy='6' r='4.5'/%3e%3cpath stroke-linejoin='round' d='M5.8 3.6h.4L6 6.5z'/%3e%3ccircle cx='6' cy='8.2' r='.6' fill='%23dc3545' stroke='none'/%3e%3c/svg%3e");
}

/* Modal mejorado */
.modal-content {
    border: none;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
}

.modal-header {
    border-bottom: 1px solid rgba(255, 255, 255, 0.2);
}

.modal-footer {
    border-top: 1px solid rgba(0, 0, 0, 0.1);
}

/* Badges mejorados */
.badge {
    font-size: 0.75em;
    padding: 0.35em 0.65em;
}

/* Estado vacío */
.text-center .fa-4x {
    font-size: 3.5rem !important;
}

/* Responsive mejoras */
@media (max-width: 768px) {
    .btn-group {
        flex-direction: column;
    }
    
    .btn-group .btn {
        margin-bottom: 0.25rem;
    }
    
    .modal-dialog {
        margin: 0.5rem;
    }
}

/* Animaciones suaves */
.card {
    transition: all 0.3s ease;
}

.alert {
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

/* Loading states */
.btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

/* Focus mejorado */
.form-control:focus {
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
    border-color: #80bdff;
}
</style>