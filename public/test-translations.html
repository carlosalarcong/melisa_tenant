<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Traducciones Melisa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
    <div class="container mt-5">
        <div class="row justify-content-center">
            <div class="col-md-8">
                <div class="card">
                    <div class="card-header">
                        <h3>ðŸ§ª Test Sistema de Traducciones Melisa Tenant</h3>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <h5>Cambiar Idioma:</h5>
                                <div class="btn-group" role="group">
                                    <button onclick="changeLanguage('es')" class="btn btn-outline-primary">ðŸ‡ªðŸ‡¸ EspaÃ±ol</button>
                                    <button onclick="changeLanguage('en')" class="btn btn-outline-primary">ðŸ‡ºðŸ‡¸ English</button>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <h5>Estado Actual:</h5>
                                <div id="status">Cargando...</div>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="row">
                            <div class="col-12">
                                <h5>APIs de Prueba:</h5>
                                <div class="d-grid gap-2">
                                    <button onclick="testApi('/api/locale/available')" class="btn btn-outline-info">
                                        Test: /api/locale/available
                                    </button>
                                    <button onclick="testApi('/test/translations')" class="btn btn-outline-warning">
                                        Test: /test/translations
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <hr>
                        
                        <div class="row">
                            <div class="col-12">
                                <h5>Resultado:</h5>
                                <pre id="result" class="bg-dark text-light p-3" style="height: 300px; overflow-y: auto;">
Esperando resultados...
                                </pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        function updateStatus() {
            document.getElementById('status').innerHTML = `
                <strong>URL:</strong> ${window.location.host}<br>
                <strong>Hora:</strong> ${new Date().toLocaleTimeString()}
            `;
        }
        
        function changeLanguage(locale) {
            document.getElementById('result').textContent = `Cambiando a idioma: ${locale}...`;
            
            fetch(`/locale/change/${locale}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'X-Requested-With': 'XMLHttpRequest'
                }
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('result').textContent = JSON.stringify(data, null, 2);
                if (data.success) {
                    setTimeout(() => {
                        window.location.reload();
                    }, 1000);
                }
            })
            .catch(error => {
                document.getElementById('result').textContent = `Error: ${error.message}`;
            });
        }
        
        function testApi(endpoint) {
            document.getElementById('result').textContent = `Probando: ${endpoint}...`;
            
            fetch(endpoint)
            .then(response => response.json())
            .then(data => {
                document.getElementById('result').textContent = JSON.stringify(data, null, 2);
            })
            .catch(error => {
                document.getElementById('result').textContent = `Error: ${error.message}`;
            });
        }
        
        // Actualizar estado cada segundo
        setInterval(updateStatus, 1000);
        updateStatus();
    </script>
</body>
</html>